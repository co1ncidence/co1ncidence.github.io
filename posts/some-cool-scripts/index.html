<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>Cool Shell Scripts I&#39;ve Found Handy</title>
	<meta name="description" content="Just a place where I rant and sometimes say something smart">
	<meta name="author" content="nuaNce">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/style.css?rnd=1600541777">
	
</head>
<body>
	<header>
	<a class="title" href="https://co1ncidence.github.io">nuaNce&#39;s blog</a>
	
	<p>
	<nav>
			
			
			<a style="text-decoration: none" href="/about/"><b>About Me /</b></a>
			
			<a style="text-decoration: none" href="/posts/"><b>Posts /</b></a>
			
			<a style="text-decoration: none" href="/books/"><b>Books /</b></a>
			
			<a style="text-decoration: none" href="/rices/"><b>Rices</b></a>
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>Cool Shell Scripts I&#39;ve Found Handy</h1>
			<b><time>09/08/2020</time></b>
		       
        	       

			<div>
				<p>Recently I&rsquo;ve gained a bit of an obsession with shell scripting. Something about just being able to write little scripts that can do big tasks for you in little time seems very appealing to me. So in this post I&rsquo;ve compiled a few of my favorite scripts, most of which I make use of on a daily basis:</p>
<h2 id="vibe">Vibe:</h2>
<p>I had used <code>mpd</code> and <code>ncmpcpp</code> for my music for a long time now, but decided to switch to <code>mpv</code> for the simplicity, and to make things even easier, I wrote this script, which shuffles all of the music files in the chosen directory and plays them in a terminal window, with album art in it&rsquo;s own small, separate window. If you wanted, you could remove the last line entirely and just manually point it to a specific file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
exec mpv --geometry<span style="color:#f92672">=</span>200x200+1600+800 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>         --shuffle <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>         --x11-name<span style="color:#f92672">=</span>no-title <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>         <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>         -- ~/usr/mus/
</code></pre></div><h2 id="upload-0x0">Upload (0x0):</h2>
<p>Written by <a href="https://github.com/vizs">vizs</a>, this one will upload the chosen file to 0x0 using <code>curl</code> and then save the output URL to your clipboard, making external hosting extremely fast and easy:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
<span style="color:#f92672">[</span> -f <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> op<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cat&#34;</span>
<span style="color:#e6db74">${</span>op<span style="color:#66d9ef">:-</span>echo<span style="color:#e6db74">}</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>@<span style="color:#66d9ef">:-$(</span>cat -<span style="color:#66d9ef">)</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>	| curl -sF file<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;@-&#39;</span> <span style="color:#e6db74">&#39;http://0x0.st&#39;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>	| tee /dev/stderr <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>	| tr -d <span style="color:#e6db74">&#39;\n&#39;</span>      <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>	| xclip -sel clip
</code></pre></div><h2 id="timer">Timer:</h2>
<p>I got this one from <a href="https://github.com/6gk">6gk</a>, you simply type <code>timer</code> then specify an amount of minutes. After the time has passed a notification will appear, alongside a bell sound:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
calc<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
	seconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>echo <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">*</span>$2<span style="color:#e6db74">&#34;</span> | bc | sed <span style="color:#e6db74">&#39;s/\..*$//&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> in
	*h<span style="color:#f92672">)</span> calc <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>1%?<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> 3600;;
	*m<span style="color:#f92672">)</span> calc <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>1%?<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>   60;;
	*s<span style="color:#f92672">)</span> seconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>1%?<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>  ;;
	*<span style="color:#f92672">)</span>  calc <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>       60;;
<span style="color:#66d9ef">esac</span>

echo <span style="color:#e6db74">&#34;timer set for </span>$1<span style="color:#e6db74"> (</span>$seconds<span style="color:#e6db74">) </span><span style="color:#e6db74">${</span>2:+- $2<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">{</span>
	sleep <span style="color:#e6db74">&#34;</span>$seconds<span style="color:#e6db74">&#34;</span>

	paplay <span style="color:#e6db74">&#34;/usr/share/sounds/freedesktop/stereo/complete.oga&#34;</span> |: &amp;
	notify-send -u critical <span style="color:#e6db74">&#34;Times Up!&#34;</span> <span style="color:#e6db74">&#34;</span>$2<span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span> &amp;
</code></pre></div><h2 id="vtog">VTOG:</h2>
<p>Just converts a video to a GIF using FFMPEG:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
ffmpeg <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>	-ss <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>	-i <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>	-vf <span style="color:#e6db74">&#34;fps=30,scale=1200:-1: \
</span><span style="color:#e6db74">	     flags=lanczos,split[s0][s1]; \
</span><span style="color:#e6db74">	     [s0]palettegen[p]; \
</span><span style="color:#e6db74">	     [s1][p]paletteuse&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>	-loop <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>	<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>echo <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> | grep -o <span style="color:#e6db74">&#34;[^.]*</span>$<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">.gif&#34;</span>
</code></pre></div><h2 id="up">UP:</h2>
<p>Minimal uptime script that outputs in <code>xh</code> for easy parsing:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
read -r uptime _ &lt; /proc/uptime

up<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>uptime%.*<span style="color:#e6db74">}</span>

hours<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span> <span style="color:#f92672">(</span> up <span style="color:#f92672">%</span> <span style="color:#ae81ff">86400</span> <span style="color:#f92672">)</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">3600</span> <span style="color:#66d9ef">))</span>

printf <span style="color:#e6db74">&#39;%s\n&#39;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>hours<span style="color:#e6db74">}</span><span style="color:#e6db74">h&#34;</span>
</code></pre></div><h2 id="download">Download:</h2>
<p>Downloads a video from YouTube using <code>youtube-dl</code> in mp3 format, since thumbnail embedding does get buggy sometimes, I have disabled it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
youtube-dl <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --config-location ~/etc/youtube-dlg/settings.json <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    -x <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --audio-format mp3 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
</code></pre></div><h2 id="centerwindow">Centerwindow</h2>
<p>Taken shamelessly from the <a href="https://github.com/wmutils/core">wmutils readme</a>, this script will center a window, regardless of WM:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
WID<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>pfw<span style="color:#66d9ef">)</span>
WW<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>wattr w $WID<span style="color:#66d9ef">)</span>
WH<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>wattr h $WID<span style="color:#66d9ef">)</span>

ROOT<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>lsw -r<span style="color:#66d9ef">)</span>
SW<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>wattr w $ROOT<span style="color:#66d9ef">)</span>
SH<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>wattr h $ROOT<span style="color:#66d9ef">)</span>

wtp <span style="color:#66d9ef">$((</span><span style="color:#f92672">(</span>SW <span style="color:#f92672">-</span> WW<span style="color:#f92672">)/</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">))</span> <span style="color:#66d9ef">$((</span><span style="color:#f92672">(</span>SH <span style="color:#f92672">-</span> WH<span style="color:#f92672">)/</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">))</span> $WW $WH $WID
</code></pre></div><h2 id="dl">DL</h2>
<p>Just a curl script that will always work, has a neat little progress bar as well. I mostly made this to avoid having to use curl flags over and again:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
<span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">{</span> read -r inp <span style="color:#f92672">&amp;&amp;</span> set <span style="color:#e6db74">&#34;</span>$inp<span style="color:#e6db74">&#34;</span> ; <span style="color:#f92672">}</span>

usage<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    &gt;&amp;<span style="color:#ae81ff">2</span> print <span style="color:#e6db74">&#39;Usage: %s [-m] link &lt;output&gt;\n&#39;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>0##*/<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    exit <span style="color:#ae81ff">1</span>
<span style="color:#f92672">}</span>

_dl<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    curl <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        --disable <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        --ipv4 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        --location <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        --retry <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        --progress-bar <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        --continue-at - <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        --url <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        --output <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>2<span style="color:#66d9ef">:-</span><span style="color:#e6db74">${</span>1##*/<span style="color:#e6db74">}}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

mass_dl<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    tmp<span style="color:#f92672">=</span>/tmp/$$
    <span style="color:#e6db74">${</span>EDITOR<span style="color:#66d9ef">:-</span>vi<span style="color:#e6db74">}</span> $tmp
    count<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">while</span> read -r url name ; <span style="color:#66d9ef">do</span>
        count<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>count <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#66d9ef">))</span>
        _dl <span style="color:#e6db74">&#34;</span>$url<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$count<span style="color:#e6db74">-</span><span style="color:#e6db74">${</span>name<span style="color:#66d9ef">:-</span>download.jpg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> &amp;
    <span style="color:#66d9ef">done</span> &lt; $tmp
    wait
    rm $tmp
<span style="color:#f92672">}</span>

main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">${</span>1#-<span style="color:#e6db74">}</span> in
        h<span style="color:#f92672">)</span> usage ;;
        m|v<span style="color:#f92672">)</span> mass_dl ;;
        *<span style="color:#f92672">)</span> _dl <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
    <span style="color:#66d9ef">esac</span>
<span style="color:#f92672">}</span>

main <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
</code></pre></div><h2 id="ext">EXT</h2>
<p>Detects what kind of archive you are pointing it at and extracts it properly, I made this to remove my dependency on GUI file managers:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>
usage<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    &gt;&amp;<span style="color:#ae81ff">2</span> printf <span style="color:#e6db74">&#39;%s\n&#39;</span> <span style="color:#e6db74">&#34;Usage: </span><span style="color:#e6db74">${</span>0##*/<span style="color:#e6db74">}</span><span style="color:#e6db74"> [-c copy_path] file&#34;</span>
    exit <span style="color:#ae81ff">1</span>
<span style="color:#f92672">}</span>

decompress<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">${</span>1##*.<span style="color:#e6db74">}</span> in
        gz|tgz<span style="color:#f92672">)</span>  gunzip -qdc <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> ;;
        xz|txz<span style="color:#f92672">)</span>  xz -qdcT <span style="color:#ae81ff">0</span> <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>  ;;
        bz2|tbz<span style="color:#f92672">)</span> bunzip2 -qdc <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> ;;
    <span style="color:#66d9ef">esac</span>
<span style="color:#f92672">}</span>

run<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">case</span> $1 in
        *tar.*|*.tgz|*.txz|*.tbz<span style="color:#f92672">)</span>
            decompress <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> | <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>            tar -C <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>COPY_PATH<span style="color:#66d9ef">:-</span>$PWD<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -xpf -
            ;;
        *.xz|*.gz|*.bz2<span style="color:#f92672">)</span>
            decompress <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>COPY_PATH<span style="color:#66d9ef">:-</span>$PWD<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>1%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
            ;;
        *.zip<span style="color:#f92672">)</span>
            unzip -q <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> -d <span style="color:#e6db74">&#34;</span>$2<span style="color:#e6db74">&#34;</span>
            ;;
        *.rar<span style="color:#f92672">)</span>
            unrar x <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
            ;;
        *.7z<span style="color:#f92672">)</span>
            7z x <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
            ;;
        *<span style="color:#f92672">)</span>
            &gt;&amp;<span style="color:#ae81ff">2</span> echo <span style="color:#e6db74">&#34;Unrecognized compression format: </span><span style="color:#e6db74">${</span>1##*.<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#66d9ef">esac</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">while</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">do</span>
    <span style="color:#66d9ef">case</span> $1 in
        -h|h<span style="color:#f92672">)</span>
            usage
            ;;
        -C|-c<span style="color:#f92672">)</span>
            COPY_PATH<span style="color:#f92672">=</span>$1
            ;;
        *<span style="color:#f92672">)</span>
            run <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
    <span style="color:#66d9ef">esac</span>
    shift
<span style="color:#66d9ef">done</span>
</code></pre></div>
			</div>
		</article>
	</main>
























	<footer>
	<br />
	<p>&copy; 2020 - <a href="https://github.com/co1ncidence"><b>nuaNce</b></a>.
	</p>
</footer>

</body>
</html>
